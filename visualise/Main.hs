-- | Generate some visualisations of map state

module Main where

import qualified Graphics.Rendering.Diagrams as D
import PlanetWars
import StringLike
import Vis


-- ---------------------------------------------------------------------

fVisBot =
  let 
    (planets,fleets) = head $ parseGameState $ concat mapWhiteside                      
    diag = makeDiag planets fleets
  in 
    --show (planets,fleets)
    renderDiag diag
  
-- ---------------------------------------------------------------------

main = fVisBot

-- ---------------------------------------------------------------------

mapStr = [
   "P 10.840348964 11.5332290838 0 114 3\n",
   "P 0.576108731347 22.7745040746 1 100 5\n",
   "P 21.1045891966 0.291954092956 2 100 5\n",
   "P 18.0562350009 1.72809803672 0 3 5\n",
   "P 3.6244629271 21.3383601308 0 3 5\n",
   "P 11.3799713178 20.847530038 0 8 3\n",
   "P 10.3007266102 2.21892812953 0 8 3\n",
   "P 16.0512166362 19.0871026134 0 16 1\n",
   "P 5.62948129175 3.97935555418 0 16 1\n",
   "P 11.1591909212 16.8074649675 0 72 3\n",
   "P 10.5215070068 6.25899320004 0 72 3\n",
   "P 3.95581121455 0.0 0 74 5\n",
   "P 17.7248867134 23.0664581676 0 74 5\n",
   "P 6.84895300719 5.1007588417 0 56 3\n",
   "P 14.8317449208 17.9656993259 0 56 3\n",
   "P 0.0 5.86108744956 0 85 2\n",
   "P 21.680697928 17.205370718 0 85 2\n",
   "P 19.9963643377 2.67917262788 0 24 1\n",
   "P 1.68433359029 20.3872855397 0 24 1\n",
   "P 3.33979657574 18.9410220747 0 88 3\n",
   "P 18.3409013522 4.12543609287 0 88 3\n",
   "P 6.77101934829 13.1633290558 0 89 2\n",
   "P 14.9096785797 9.90312911175 0 89 2\n",
   "go\n"
   ]

mapStr2 = 
  [
  "P 11.152765 11.261845 0 119 1\n",
  "P 19.323053 19.415083 1 45 5\n",
  "P 2.982476 3.108607 2 58 5\n",
  "P 17.544563 22.212924 0 45 1\n",
  "P 4.760966 0.310766 0 45 1\n",
  "P 10.084655 4.773044 2 8 5\n",
  "P 12.220874 17.750646 1 1 5\n",
  "P 21.406539 17.735427 0 86 1\n",
  "P 0.898990 4.788263 0 86 1\n",
  "P 0.000000 2.053054 0 59 1\n",
  "P 22.305529 20.470636 0 59 1\n",
  "P 3.808495 5.491990 0 69 5\n",
  "P 18.497034 17.031701 1 38 5\n",
  "P 8.841685 12.712220 0 57 4\n",
  "P 13.463845 9.811470 0 57 4\n",
  "P 13.635701 7.877295 0 17 5\n",
  "P 8.669829 14.646395 0 17 5\n",
  "P 6.688247 18.076397 0 66 5\n",
  "P 15.617282 4.447293 0 66 5\n",
  "P 16.918396 0.696320 0 70 5\n",
  "P 5.387133 21.827370 0 70 5\n",
  "P 13.198469 0.000000 0 79 2\n",
  "P 9.107060 22.523690 0 79 2\n",
  "F 2 22 2 15 12 3\n",
  "F 2 1 2 20 19 11\n",
  "F 2 18 2 16 13 5\n",
  "F 2 3 2 16 13 6\n",
  "F 2 4 2 16 13 7\n",
  "F 2 1 2 5 8 3\n",
  "F 2 4 2 16 13 9\n",
  "F 2 4 2 16 13 10\n"
  ]

mapWhiteside = [
   "P 11.579376 11.554042 0 150 0\n",
   "P 11.667471 12.485644 2 11 5\n",
   "P 11.491280 10.622441 1 8 5\n",
   "P 6.467471 8.738467 0 56 4\n",
   "P 16.691280 14.369617 0 56 4\n",
   "P 2.343490 10.691485 1 1 3\n",
   "P 20.815261 12.416600 1 1 3\n",
   "P 17.773524 18.239086 0 15 2\n",
   "P 5.385228 4.868999 0 15 2\n",
   "P 2.868881 2.143556 0 90 2\n",
   "P 20.289870 20.964529 0 90 2\n",
   "P 18.674578 4.825621 0 60 2\n",
   "P 4.484174 18.282463 0 60 2\n",
   "P 8.853196 10.925516 1 31 5\n",
   "P 14.305555 12.182568 2 10 5\n",
   "P 16.899850 23.108085 0 76 5\n",
   "P 6.258901 0.000000 0 76 5\n",
   "P 7.054547 3.960942 0 67 3\n",
   "P 16.104204 19.147143 0 67 3\n",
   "P 0.000000 19.094381 0 57 4\n",
   "P 23.158751 4.013704 0 57 4\n",
   "P 13.804757 17.287464 0 82 5\n",
   "P 9.353994 5.820621 0 82 5\n",
   "F 2 5 14 2 4 1\n",
   "F 2 5 14 2 4 2\n",
   "F 2 5 1 2 2 1\n",
   "F 2 5 14 2 4 3\n"
   ]

-- EOF
